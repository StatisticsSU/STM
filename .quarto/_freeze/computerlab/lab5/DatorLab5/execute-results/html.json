{
  "hash": "d8b6ae0e3822a53e860a6a83aab7c124",
  "result": {
    "markdown": "---\ntitle: \"Statistik och dataanalys I, 15 hp \"\nsubtitle: \"Datorlaboration 5 - Simulering\"\nauthor: \n  - Mattias Villani\ndate: last-modified\nformat: \n  html:\n    self-contained: true\ntoc: true\nexecute:\n  error: false\nlanguage: \n  title-block-author-single: \" \"\ntoc-title-document: \"Inneh√•ll\"\ncrossref-fig-title: \"Figur\"\ntheme: Superhero\ntitle-block-banner-color: Primary\ntitle-block-published: \"Publicerad\"\ncallout-warning-caption: \"Varning\"\ncallout-note-caption: \"Observera\"\ncallout-tip-caption: \"Tips\"\neditor: visual\n---\n\n\n## Introduktion och viktig f√∂rberedande information\n\n> I den h√§r datorlabben kommer vi att arbeta med f√∂rdelningar i R, bland annat l√§ra oss g√∂ra sannolikhetsber√§kningar och simulera fr√•n olika f√∂rdelningar, dvs dra slumptal fr√•n f√∂rdelningar.\n\n::: callout-warning\n## Installera paket\n\nDen h√§r labben f√∂ruts√§tter inga installerade paket.\n:::\n\n::: callout-important\n## Skapa mapp f√∂r labben\n\nSkapa en mapp `Lab5` i din kursmapp SDA1. Ladda ner Quarto-filen f√∂r denna lab genom att h√∂gerklicka [h√§r](https://github.com/StatisticsSU/SDA1/raw/main/datorlab/lab5/DatorLab5.qmd) och v√§lj 'Spara l√§nk' eller n√•got likande fr√•n menyn som dyker upp. Spara filen i din `Lab5` mapp. √ñppna Quarto-filen i RStudio och forts√§tt med denna laboration direkt i Quarto-dokumentet, d√§r du ocks√• fyller i svaren p√• dina laborations√∂vningar.\n:::\n\n### F√∂rdelningar i R: r, p, d och q-funktionerna üòç\n\nR har en massa statistiska f√∂rdelningar inbyggda fr√•n start, och ytterligare m√•nga, m√•nga mer i olika R-paket. F√∂r varje f√∂rdelning finns det fyra typer av funktioner:\n\n-   **r**-funktionen som genererar slumptal fr√•n f√∂rdelningen, t ex `rnorm(n = 5, mean = 2, sd = 3)` genererar 5 slumptal fr√•n normalf√∂rdelningen $X\\sim N(2,3)$. Argumentet `sd` betyder standard deviation, dvs standardavvikelse. Tio slumptal fr√•n Poissonf√∂rdelningen $\\mathrm{Pois}(\\lambda = 2)$ f√•r man med `rpois(n = 10, lambda = 2)` osv. r-funktionen har f√•tt sitt namn fr√•n **r**andom.\n\n-   **p**-funktionen som ber√§knar sannolikheten att slumpvariabeln √§r mindre √§n ett visst tal, dvs $P(X\\leq x)$ f√∂r n√•got $x$. p-funktionen har f√•tt sitt namn fr√•n engelskans **p**robability.\\\n    `pnorm(q = 1, mean = 2, sd = 3)` ber√§knar sannolikheten att $X\\sim N(2,3)$ √§r mindre √§n 1.\n\n-   **d**-funktionen som f√∂r en diskret variabel $X$ ber√§knar sannolikheten $P(X=x)$. F√∂r en kontinuerlig variabel ber√§knar d-funktionen t√§thetsfunktionen $f(x)$ i en given punkt $x$. Det √§r fr√•n det kontinuerliga fallet som d-funktionen f√•tt sitt namn, d som i **d**ensity. Kommandot `dnorm(x = 0, mean = 2, sd = 3)` ber√§knar t√§thetsfunktionens v√§rde i punkten $x=0$, dvs $f(0)$ f√∂r en $X\\sim N(2,3)$ variabel.\n\n-   **q**-funktionen ber√§knar $p$-kvantilen f√∂r en f√∂rdelning, dvs det v√§rde $x$ d√§r $P(X \\leq x)=p$. Vi kan t ex ber√§kna 25% eller 0.25-kvantilen f√∂r en normalf√∂rdelad variabel $X\\sim N (2,3)$ med kommandot `qnorm(p = 0.25, mean = 2, sd = 3)`.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code  code-fold=\"true\" code-summary=\"Visa mig koden!\"}\n    m = 2       # mean for the normal distribution\n    s = 3       # standard deviation for the normal distribution\n    x = -1      # point where the density is evaluated\n    x_grid = seq(-10, 10, by = 0.1) # a vector of x-values for which we evaluate the density f(x)\n    x_sample = rnorm(n = 1000, mean = m, sd = s)\n    dens_norm = dnorm(x_grid, mean = m, sd = s)  # density (x) for all values in vector xgrid\n    quantile10 = qnorm(0.1, mean = m, sd = s)    # 10% percentile\n    \n    # Plotting - a lot of code because I want pretty colors and legends. Sorry.\n    hist(x_sample, breaks = 50, freq = F, main = \"X ~ N(2,3¬≤)\", ylim = c(0,0.15), \n         xlim = c(-10,10), xlab = \"x\", ylab = \"f(x)\", col = \"cornflowerblue\") # freq = F gives us proportions\n    lines(x_grid, dens_norm, lwd = 3, col = \"orange\")\n    density_at_x = dnorm(x, mean = m, sd = s)\n    points(x, density_at_x)\n    lines(x = c(x,x), c(0,density_at_x), col = \"gray\", lty = 2, lwd = 3)\n    lines(x = c(-10,x), c(density_at_x,density_at_x), col = \"gray\", lty = 2, lwd = 2)\n    x_lower = x_grid[x_grid < quantile10]\n    polygon(x = c(x_lower, rev(x_lower)), border = NA,\n            y = c(rep(0, length(x_lower)), rev(dnorm(x_lower, mean = m, sd = s))), \n            col = rgb(1,0.8431373,0, alpha = 0.7)\n    )\n    legend(\"topleft\", inset=.01, \n           legend=c(\"histogram data\", \"density function\", \"density evaluation\", \"P(X<=-1)\"),\n           col=c(\"cornflowerblue\", \"orange\", \"gray\"), \n           lty = c(NA, 1, 3, NA), \n           lwd = c(NA, 2, 2, NA), \n           fill = c(\"cornflowerblue\", NA, NA, rgb(1,0.8431373,0, alpha = 0.7)), \n           border = c(1,0,0,1), cex=1\n    )\n    ```\n    \n    ::: {.cell-output-display}\n    ![](DatorLab5_files/figure-html/unnamed-chunk-1-1.png){width=672}\n    :::\n    :::\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\ndnorm to compute density at -1: f(x) = 0.0806569081730478\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\npnorm to compute prob that X is lower than -1: P(X<=x) = 0.158655253931457\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nqnorm to compute 10% quantile of X as  -1.8446546966338\n```\n:::\n:::\n\n\n::: callout-tip\n## Gl√∂m inte Rs hj√§lp!\n\nSkriv t ex `?rnorm` i Console f√∂r att se hj√§lpfilen f√∂r normalf√∂rdelningen.\n:::\n\n::: callout-note\nJag har skrivit ut namnen p√• alla funktionsargumenten ovan, t ex `n=5`, `mean = 2` och `sd = 3` i `rnorm(n = 5, mean = 2, sd = 3)`. Det hade dock g√•tt lika bra att skriva `rnorm(5, 2, 3)`, d√• f√∂rst√•r R att jag menar `n=5`, `mean = 2` och `sd = 3` . Det fungerar dock bara om man anv√§nder exakt den **ordning** p√• argumenten som man ser n√§r man skriver `?rnorm`. Annars kan R inte veta vilka argument som ska matchas mot vilka siffror. Om man skriver ut argumentens namn s√• kan man ha vilken ordning som helst, t ex `rnorm(mean = 2, sd = 3, n = 5)`.\n:::\n\n::: callout-note\n## Vektorisera mera\n\nKommandot `dnorm(0, mean = 0, sd = 1)` r√§knar ut t√§thetsfunktionens v√§rde i punkten `x=0` f√∂r en standard normalf√∂rdelning. Om man vill r√§kna ut t√§theten i flera punkter? Ett s√§tt √§r att anv√§nda en `for`-loop som upprepar `dnorm(x, mean = 0, sd = 1)` f√∂r olika x-v√§rden (se Lab1). Men det finns ett enklare s√§tt! M√•nga av Rs funktioner √§r **vektoriserade**. Det betyder att du kan r√§kna ut funktionen f√∂r *alla* v√§rden i en vektor 'p√• en g√•ng'. üòç\\\nS√• h√§r ber√§knar man t ex t√§thetsfunktionen f√∂r tre olika x-v√§rden -1, 0, och 1:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndnorm(x = c(-1,0,1), mean = 0, sd = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2419707 0.3989423 0.2419707\n```\n:::\n:::\n\n\nOk, snyggt, men om man vill ha *olika* v√§ntev√§rden f√∂r var och ett av x-v√§rdena, d√•? Yep, funkar:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndnorm(x = c(-1,0,1), mean = c(0, 0.5, 3), sd = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.24197072 0.35206533 0.05399097\n```\n:::\n:::\n\n:::\n\n::: callout-warning\n## Normalf√∂rdelning med varians eller standardavvikelse?\n\nI funktionen `rnorm()` anger man f√∂rdelningens spridning som en standardavvikelse med argumentet `sd`. Det motsvarar att man skriver $N(\\mu,\\sigma)$ f√∂r en normalf√∂rdelning i matematisk/symbolisk notation. M√•nga b√∂cker skriver dock normalf√∂rdelningen med **variansen** som andra argument i den symboliska beskrivningen: $N(\\mu,\\sigma^2)$. Man f√•r helt enkelt se upp och kontrollera om en normalf√∂rdelning skrivs med en standardavvikelse eller varians. I formelsamlingen och p√• tentan har jag kommer jag skriva $N(\\mu,\\sigma)$, som boken g√∂r.\n:::\n\n### Rita upp sannolikhetsf√∂rdelningen f√∂r en diskret variabel\n\nVi ska nu f√∂rs√∂ka g√∂ra ett stapeldiagram f√∂r sannolikhetsf√∂rdelningen f√∂r en binomialf√∂rdelad variabel med parametrarna $n=10$ och $p=0.4$, dvs f√∂r slumpvariabeln $X\\sim \\mathrm{Binom}(n,p)$. Vi har ju just sett att vi kan ber√§kna sannolikheterna $P(X=x)$ f√∂r en massa olika $x$-v√§rden genom vektorisering, s√• l√•t oss b√∂rja d√§r:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn = 10\np = 0.4\nxvalues = seq(0,n) # en vektor med alla m√∂jliga utfall p√• X, dvs 0,1,2,...,n\nprobs = dbinom(x = xvalues, size = n, prob = p) # vektoriserat \nprobs\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 0.0060466176 0.0403107840 0.1209323520 0.2149908480 0.2508226560\n [6] 0.2006581248 0.1114767360 0.0424673280 0.0106168320 0.0015728640\n[11] 0.0001048576\n```\n:::\n:::\n\n\nNotera hur jag f√∂rst skapade en vektor med alla x-v√§rden (`xvalues`) mellan $0$ och $n=10$ (vilket ju √§r alla m√∂jliga x-v√§rden f√∂r en $\\mathrm{Bin}(10,p)$-f√∂rdelad variabel). Den vektorn matade jag sen in i `dbinom()` funktionen f√∂r att f√• sannolikheten $P(X=x)$ f√∂r *varje* x-v√§rde. Vi ser att sannolikheten f√∂r $x=0$ √§r v√§ldigt l√•g $P(X=0)=0.0060466176$. Den sannolikheten √§r l√§tt att r√§kna f√∂r hand som kontroll: det enda s√§tt vi kan f√• 0 lyckade f√∂rs√∂k i 10 Bernoullif√∂rs√∂k √§r om vi misslyckas (vars sannolikhet √§r $q=1-p=1-0.4=0.6$) p√• alla 10 f√∂rs√∂k: $0.6^{10}=0.006046618$. Yes, checks out.\n\nKoden nedan g√∂r nu ett stapeldiagram √∂ver sannolikhetsf√∂rdelningen. Notera att vi m√•ste anv√§nda `names()` funktionen f√∂r s√§tta ett \"namn\" p√• varje sannolikhet (dvs det x-v√§rde som sannolikheten h√∂r ihop med) f√∂r att vi ska f√• $x$-v√§rdena utskrivna p√• $x$-axeln.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(probs) <- xvalues\nbarplot(probs, col = \"cornflowerblue\", ylab = \"P(X=x)\", xlab = \"x\", main = \"X ~ Binom(10,0.4)\")\n```\n\n::: {.cell-output-display}\n![](DatorLab5_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nHur g√∂r man om slumpvariabeln kan anta ett o√§ndligt antal v√§rden, som t ex Poissonf√∂rdelningen d√§r $x=0,1,2,‚Ä¶.$ utan √∂vre gr√§ns? L√∂sningen √§r att l√•ta vektorn med x-v√§rden inneh√•lla alla x-v√§rden d√§r sannolikheten $P(X=x)$ √§r tillr√§ckligt stor f√∂r att spela roll i figuren. H√§r kan prova sig fram, dvs √∂ka p√• antalet x-v√§rden tills sannolikheten f√∂r st√∂rre x-v√§rden √§r n√§ra noll. S√• h√§r kan vi t ex g√∂ra ett stapeldiagram √∂ver sannolikhetsf√∂rdelningen f√∂r en $\\mathrm{Pois}(\\lambda = 2)$ variabel:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nxvalues = 0:5\nprobs = dpois(x = xvalues, lambda = 2)\nnames(probs) <- xvalues\nbarplot(probs, col = \"orange\", xlab  = \"x\", ylab = \"P(X=x)\", main = \"Poisson med lite f√∂r f√• x-v√§rden\")\n```\n\n::: {.cell-output-display}\n![](DatorLab5_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nSom du ser var jag lite f√∂r sn√•l med antal x-v√§rden, det verkar som om x-v√§rden st√∂rre √§n 5 borde ha varit med i plotten eftersom sannolikheten f√∂r x=5 √§r inte riktigt n√§ra noll. L√•t oss prova med v√§rden fr√•n 0 till 10:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nxvalues = 0:10\nprobs = dpois(x = xvalues, lambda = 2)\nnames(probs) <- xvalues\nbarplot(probs, col = \"yellow\", xlab  = \"x\", ylab = \"P(X=x)\", main = \"Poisson med lagom m√•nga x-v√§rden\")\n```\n\n::: {.cell-output-display}\n![](DatorLab5_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n### Rita upp t√§thetsfunktionen f√∂r en kontinuerlig variabel\n\nHur kan man rita upp sannolikheterna f√∂r en kontinuerlig variabel? Kontinuerliga variabler antar ju alla v√§rden, √§ven decimaltal, s√• h√§r m√•ste vi g√∂ra lite annorlunda. En kontinuerlig variabel har ju ocks√• sannolikhet noll f√∂r alla $x$: $P(X=x)=0$. Vi anv√§nder oss d√§rf√∂r av t√§thetsfunktionen $f(x)$, d√§r arean under t√§thetsfunktionen mellan tv√• x-v√§rden $a$ och $b$ √§r sannolikheten $P(a \\leq X \\leq b)$. Den s k d-funktionen (t ex `dnorm` f√∂r normalf√∂rdelning) ger t√§theten f√∂r en kontinuerlig variabel. F√∂r att plotta upp en t√§thetsfunktion:\n\n-   skapa en vektor med en massa x-v√§rden med ganska litet avst√•nd mellan v√§rdena\n\n-   ber√§kna d-funktionen f√∂r vektorn med x-v√§rden\n\n-   plotta t√§thetsfunktionen som en kurva med kommandot `plot()` eller `lines()` (anv√§nds om det inte redan finns n√•got uppritat i grafen).\n\nH√§r plottar vi t√§thetsfunktionen f√∂r en standard normalf√∂rdelningen:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nxvalues = seq(-3, 3, by = 0.01) # by=0.01 talar om att vi vill ha avst√•nd 0.01 mellan v√§rdena.\ndensity_values = dnorm(xvalues, mean = 0, sd = 1)\nplot(xvalues, density_values, type = \"l\", xlab = \"x\", ylab = \"density\", main = \"N(0,1)\",\n     col = \"steelblue\", lwd = 2) # lwd √§r line width, dvs tjocklek p√• linje.\n```\n\n::: {.cell-output-display}\n![](DatorLab5_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nI det h√§r fallet var det ganska l√§tt att v√§lja start- och slutpunkt f√∂r x-v√§rdena: vi vet ju fr√•n 68-95-99.7 regeln att 99.7% av sannolikhetsmassan ligger mellan -3 och 3 f√∂r standard normalf√∂rdelning. I andra fall kan det vara sv√•rare att best√§mma l√§mpliga x-v√§rden och man f√•r prova sig fram (om man har en q-funktion, dvs kvantilfunktion, f√∂r f√∂rdelningen kan man anv√§nda den f√∂r att ber√§kna l√§mpliga start- och slutv√§rden p√• x). Hur v√§ljer man avst√•ndet mellan olika x-v√§rden (dvs `by = 0.01` i min kod)? Det brukar spela mindre roll. V√§ljer man f√∂r stora avst√•nd blir kurvan hackig. V√§ljer man verkligt sm√• avst√•nd blir det m√•nga olika x-v√§rden och det kan ta tid f√∂r R ber√§kna alla t√§thetsv√§rden.\n\n## 1. R√§kna med sannolikhetsf√∂rdelningar\n\n#### üí™ Uppgift 1.1\n\nL√•t $X\\sim \\mathrm{Pois}(\\lambda)$ med $\\lambda = 2$. Ber√§kna $P(X=2)$ och $P(X\\leq 3)$. Hint: `?ppois`\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Write your code here\n```\n:::\n\n\n#### üí™ Uppgift 1.2\n\nI valet 2022 fick Liberalerna 4.61% av r√∂sterna. I en unders√∂kning bland totalt 1046 personser angav 30 personer att de skulle r√∂sta p√• Liberalerna om det var val idag. Kan det vara s√• att Liberalernas r√∂stningsandel √§r (ungef√§r) of√∂r√§ndrad p√• 4.61%, eller tyder den nya unders√∂kningen p√• n√•got annat? Unders√∂k detta genom att rita upp ett stapeldiagram √∂ver sannolikhetsf√∂rdelningen $P(X=x)$ f√∂r $X \\sim \\mathrm{Binom}\\operatorname{}(n= 1046, p = 0.0461)$ f√∂r x-v√§rdena `xvalues = 0:100`. √Ñr resultatet fr√•n valunders√∂kningen ett sannolikt utfall? Om inte, vilket slutsats drar du, genom att titta i stapeldiagramet, om Liberalernas faktiska v√§ljarandel?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Write your code here\n```\n:::\n\n\n#### üí™ Uppgift 1.3\n\nBer√§kna $P(X \\leq 30)$ f√∂r $X \\sim \\mathrm{Binom}(n= 1046, p = 0.0461)$ genom att anv√§nda binomialf√∂rdelningen. J√§mf√∂r svaret med samma sannolikhet fr√•n en normalapproximation (se F15):\n\n$$\nX\\sim \\mathrm{Binom}(n,p) \\text{ approximeras med } X\\sim \\mathrm{N}\\Big(\\mu=np, \\sigma = \\sqrt{n p (1-p)}\\Big)\n$$\n\nObservera att jag skrivit normalf√∂rdelningen med *standardavvikelse* som andra argument h√§r. Precis som R g√∂r.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Write your code here\n```\n:::\n\n\n## 2. Simulera slumpvariabler\n\n#### üí™ Uppgift 2.1\n\nSimulera nu 1000 slumptal fr√•n Poissonf√∂rdelningen $\\mathrm{Pois}(\\lambda)$ med $\\lambda = 2$ och spara i variabeln (vektorn) `x`. Ber√§kna medelv√§rdet (`mean(x)`) och standardavvikelsen (`sd(x)`) f√∂r slumptalen. St√§mmer de v√§rdena ungef√§r med vad vi kan f√∂rv√§nta oss? \\[hint: Poissonf√∂rdelningens teoretiska v√§ntev√§rde\\]. Simulera nu 10000 slumptal fr√•n samma f√∂rdelning och ber√§kna √•terigen medelv√§rdet. Vad tror du skulle h√§nda om du fortsatte s√• h√§r och simulerade fler och fler slumptal? (bortsett fr√•n att datorns minne skulle ta slut). \\[Hint: stora talens lag\\].\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Write your code here\n```\n:::\n\n\n#### üí™ Uppgift 2.2\n\nAntag att du inte k√§nner till funktionen `dpois` och att det matematiska uttrycket f√∂r Poissonsannolikheterna som ges i SDM boken √§r f√∂r skr√§mmande f√∂r dig. Kan du anv√§nda slumptalen i Uppgift 2.1 f√∂r att uppskatta sannolikheten $P(X=3)$?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Write your code here\n```\n:::\n\n\n#### üí™ Uppgift 2.3\n\nSimulera 1000 slumptal fr√•n exponentialf√∂rdelningen med parametern `rate = 2` (vilket √§r det som boken kallar $\\lambda$) och spara i en vektor x. Ber√§kna medelv√§rdet av slumptalen och verifiera att det √§r hyfsat n√§ra det teoretiska v√§ntev√§rdet f√∂r denna exponentialf√∂rdelning.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Write your code here\n```\n:::\n\n\n#### üí™ Uppgift 2.4\n\nRita ett histogram f√∂r slumptalen fr√•n f√∂rra uppgiften med argumentet `breaks = 40` (g√∂r att du f√•r ungef√§r 40 staplar i histogrammet). Plotta ocks√• den teoretiska t√§thetsfunktionen f√∂r $\\mathrm{Expon}(\\lambda = 2)$ i samma figur.\n\n::: callout-tip\n## Plottips\n\nAnv√§nd `lines()` n√§r du plottar t√§thetsfunktionen, annars kommer histogrammet att skrivas √∂ver. Anv√§nd argumentet `freq = FALSE` i `hist()`-funktionen s√• du f√•r andelen observationer i varje bin, och inte antalet. Annars kommer histogrammet och t√§thetsfunktionen inte att ha samma skala p√• y-axeln.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Write your code here\n```\n:::\n\n\n## 3. Simulering f√∂r att ber√§kna nya f√∂rdelningar\n\nEn mycket trevlig egenskap med simulering √§r att det √§r v√§ldigt enkelt att ber√§kna f√∂rdelningen f√∂r en **funktion** av slumpvariabler. Vi vet ju t ex att om $X\\sim \\operatorname{N}(\\mu,\\sigma^2)$ s√• √§r f√∂rdelningen f√∂r linj√§rkombinationen $Y=c+aX$ ocks√• normalf√∂rdelad: $Y\\sim \\operatorname{N}(c+a\\mu, a^2 \\sigma ^2)$. Men det √§r l√•ngt ifr√•n alla fall d√§r vi matematiskt kan bevisa s√•dana goa resultat. Med simulering kan vi f√• fram f√∂rdelningen f√∂r *alla* funktioner och √§ven f√∂rdelningen f√∂r en summa av slumpvariabler, och mer. Den kan vi √§ven g√∂ra om f√∂rdelningen f√∂r $X$ √§r n√•got annat √§n normalf√∂rdelad. L√•t oss testa direkt i en √∂vning!\n\n#### üí™ Uppgift 3.1\n\nDin v√§n och du ska best√§lla hem mat. Ni har olika smak och du vill best√§lla fr√•n restaurang X, din v√§n vill best√§lla fr√•n restaurang Y. Ni vill s√•klart g√§rna √§ta maten samtidigt och lovar varandra att v√§nta med att √§ta tills b√•da f√•tt maten. L√•t $X \\sim \\mathrm{Expon}(\\lambda = 2)$ vara v√§ntetiden i timmar tills restaurang X levererar mat hem till dig, och $Y \\sim \\mathrm{Expon}(\\lambda = 4)$ √§r v√§ntetiden f√∂r restaurang Y. Antag att $X$ och $Y$ √§r oberoende slumpvariabler. Slumpvariabeln $Z=60(X-Y)$ m√§ter d√• hur m√•nga minuter du m√•ste v√§nta p√• maten efter att din v√§n redan f√•tt maten, dvs hur l√§nge din artiga v√§n m√•ste v√§nta innan hen kan b√∂rja √§ta. Om $Z$ √§r negativ har du allts√• f√•tt maten f√∂re din v√§n. H√§r ser man direkt att $Z=60(X-Y)$ inte kan vara exponentialf√∂rdelad, $Z$ kan ju vara negativ! Anv√§nd simulering f√∂r att simulera fr√•n f√∂rdelningen f√∂r $Z$ och rita upp ett histogram f√∂r att representera t√§thetsfunktionen (anv√§nd argumentet `freq = FALSE` f√∂r att f√• andelar inom varje bin). Anv√§nd simuleringen f√∂r att uppskatta sannolikheten att du f√•r maten efter din v√§n. \\[Hint1: Prova att skriva `Z>0` i Console. Hint2: R hanterar TRUE som 1 och FALSE som 0, s√• t ex `sum(c(TRUE, FALSE, TRUE))` blir 2 i R\\].\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Write your code here\n```\n:::\n\n\n#### üí™ Uppgift 3.2\n\nUppskatta variansen f√∂r $Z$ genom simulering. Verifiera att uppskattningen √§r hyfsat n√§ra den teoretiska variansen f√∂r f√∂r $Z$. \\[Hint: F14 gav oss formler f√∂r variansen av en summa och en differens av oberoende variabler och F16 har egenskaper f√∂r exponentialf√∂rdelade variabler, t ex deras varians.\\]\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Write your code here\n```\n:::\n\n\n## 4. Analys av antalet bes√∂k till webbsida\n\nEn webbsida registrerade n√§r bes√∂kare bes√∂kte deras webbsida under ett dygn. H√§r √§r en grafisk illustration av antalet bes√∂k under dygnet, varje streck √§r ett bes√∂k vid en viss tidpunkt:\n\n![](https://github.com/StatisticsSU/SDA1/raw/main/datorlab/lab5/website_times.svg){fig-align=\"center\"}\n\nAntalet bes√∂k f√∂r var och ett av dygnets timmar var\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvisits_per_hour = c(0, 1,  6,  0,  1,  0,  1,  0,  3,  0,  0,  0,  0,  2,  2, \n                    0,  1,  9,  1,  1,  0,  1,  0,  0)\n```\n:::\n\n\nAntag att *antalet bes√∂k per timme* kan modelleras som oberoende Poissonf√∂rdelade variabler med parameter $\\lambda$. Vi vill nu best√§mma det b√§sta v√§rdet p√• $\\lambda$ genom att anv√§nda data. En vanlig **skattning** av $\\lambda$ i en Poissonf√∂rdelning √§r medelv√§rdet $\\bar x$ av data (det √§r t ex den skattning man f√•r med den s k **maximum likelihoodmetoden**).\n\n#### üí™ Uppgift 4.1\n\nSkatta parametern $\\lambda$ fr√•n variabeln `visits_per_hour` .\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Write your code here\n```\n:::\n\n\n#### üí™ Uppgift 4.2\n\nF√∂retaget som driver webbsidan vill veta sannolikheten att de f√•r fler √§n 5 bes√∂kare under **√•tminstone n√•gon** av morgondagens 24 timmar. Anv√§nd din skattade Poissonmodell f√∂r att ber√§kna den sannolikheten. \\[hint: union och komplement\\].\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Write your code here\n```\n:::\n\n\n#### üí™ Uppgift 4.2\n\n\\\nUnders√∂k om Poissonf√∂rdelningen verkar anpassa dessa data bra. Du kan t ex unders√∂ka om det teoretiska v√§ntev√§rdet och variansen i den skattade Poissonmodellen ligger hyfsat n√§ra medelv√§rdet och stickprovsvariansen i data. Du kan ocks√• kolla hur sannolikt det faktiskt √§r att observera 9 st bes√∂k under en timme (som vi ju ser i data mellan kl 17-18) i den skattade Poissonmodellen.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Write your code here\n```\n:::\n",
    "supporting": [
      "DatorLab5_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}