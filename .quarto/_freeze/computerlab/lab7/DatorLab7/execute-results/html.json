{
  "hash": "331e69ef27b5865343d582075d5bef71",
  "result": {
    "markdown": "---\ntitle: \"Statistik och dataanalys I, 15 hp \"\nsubtitle: \"Datorlaboration 7 - Inferens f칬r regression\"\nauthor: \n  - Mattias Villani\ndate: last-modified\nformat: \n  html:\n    self-contained: true\ntoc: true\nexecute:\n  error: false\nlanguage: \n  title-block-author-single: \" \"\ntoc-title-document: \"Inneh친ll\"\ncrossref-fig-title: \"Figur\"\ntheme: Superhero\ntitle-block-banner-color: Primary\ntitle-block-published: \"Publicerad\"\ncallout-warning-caption: \"Varning\"\ncallout-note-caption: \"Observera\"\ncallout-tip-caption: \"Tips\"\neditor: visual\n---\n\n\n::: callout-warning\n## Installera paket\n\nDen h칛r labben f칬ruts칛tter att f칬ljande paket finns installerade:\n\n-   `mosaic`\n-   `sda123`\n\nsda123 칛r kursens egna R-paket och m친ste installeras fr친n GitHub. Det g칬rs genom att f칬rst installera paketet remotes och d칛refter installera kurspaketet:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mosaic)\n# install.packages(\"remotes\") # avkommentera f칬rsta g친ngen\nlibrary(remotes)\n#install_github(\"StatisticsSU/sda1paket\")  # avkommentera f칬rsta g친ngen\nlibrary(sda123)\n```\n:::\n\n:::\n\n## Introduktion\n\n> I den h칛r datorlabben kommer ni analysera olika datamaterial med regression. Det f칬rsta datamaterialet om reklam 칛r verkligt. I Uppgift 3 ska ni analysera datamaterial som 칛r simulerade av mig, fr친n olika populationsmodeller som jag har valt. Det blir ett intressant laboratorium, d칛r ni kan utforska olika aspekter av regression i en kontrollerad milj칬. Och 칛ven f친 veta den underliggande populationsmodellen efter att ni gjort labben!\n\n::: callout-important\n## Skapa mapp f칬r labben\n\nSkapa en mapp `Lab7` i din kursmapp SDA1. Ladda ner Quarto-filen f칬r denna lab genom att h칬gerklicka [h칛r](https://github.com/StatisticsSU/SDA1/raw/main/datorlab/lab7/DatorLab7.qmd) och v칛lj 'Spara l칛nk' eller n친got likande fr친n menyn som dyker upp. Spara filen i din `Lab7` mapp. 칐ppna Quarto-filen i RStudio och forts칛tt med denna laboration direkt i Quarto-dokumentet, d칛r du ocks친 fyller i svaren p친 dina laborations칬vningar.\n:::\n\n## 1. Enkel regression f칬r reklamdata\n\nDatamaterialet `reklam.csv` inneh친ller data p친 *n=200* produkters f칬rs칛ljning (`sales`) i tusentals US dollar och hur mycket (i s k reklamenheter) produkten har marknadsf칬rts i olika reklamkanaler: `tv`, `radio` och `newspaper`. Vi l칛ser in data med kommandot:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreklam = read.csv(file = 'https://github.com/StatisticsSU/SDA1/raw/main/datorlab/lab7/reklam.csv')\nhead(reklam)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     tv radio newspaper sales\n1 230.1  37.8      69.2  22.1\n2  44.5  39.3      45.1  10.4\n3  17.2  45.9      69.3  12.0\n4 151.5  41.3      58.5  16.5\n5 180.8  10.8      58.4  17.9\n6   8.7  48.9      75.0   7.2\n```\n:::\n:::\n\n\nVi b칬rjar med en enkel regressionsmodell med enbart `tv` som f칬rklarande variabel. Vi utforskar data genom histogram f칬r responsvariabeln `sales` och scatterplot mot `tv`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1,2))\nhist(reklam$sales, col = \"orange\", main = \"\")\nplot(sales ~ tv, data = reklam, pch = 19, cex = 0.7, col = \"steelblue\")\n```\n\n::: {.cell-output-display}\n![](DatorLab7_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n#### 游눩 Uppgift 1.1\n\nSkatta den enkla linj칛ra regressionsmodellen i R:\n\n$$\n\\texttt{sales} = \\beta_0 + \\beta_1 \\cdot \\texttt{tv} + \\varepsilon, \\hspace{1cm} \\varepsilon\\overset{iid}{\\sim}N(0,\\sigma_{\\varepsilon})\n$$\n\noch tolka skattningen av intercept och lutningskoefficient. Vilken skattning av $\\sigma_{\\varepsilon}$ ger R, och hur tolkar du denna?\n\n#### 游눩 Uppgift 1.2\n\nTesta om variabeln tv 칛r en signifikant f칬rklarande variabel p친 5% signifikansniv친. St칛ll upp noll- och alternativhypotes, teststatistiska med f칬rdelning under nollhypotesen. Utf칬r testet med hj칛lp av formelsamlingen och formulera din slutsats. Du f친r anv칛nda information fr친n R, men du ska st칛lla upp formeln f칬r teststatistikan och ber칛kna med den formeln.\n\n#### 游눩 Uppgift 1.3\n\nVisa hur R har ber칛knat p-v칛rdet i regression-utskriften (fr친n `summary`) genom att g칬ra ber칛kningen sj칛lv med relevant s k `p`,`d`,`q`, eller `r`-funktion.\n\n#### 游눩 Uppgift 1.4\n\nG칬r en residualanalys med funktionen `reg_residuals` i `sda123`-paketet, och kommentera om var och ett av de fyra grundl칛ggande antaganden f칬r populationsmodellen verkar uppfyllda.\n\n#### 游눩 Uppgift 1.5\n\nG칬r en prediktion med 95%-igt prediktionsintervall f칬r `sales` vid `tv=100`. \\[tips: argumentet `newdata` i `predict`-funktionen m친ste vara en dataframe, inte en vektor. Se min [kod f칬r lifespan data](https://statisticssu.github.io/SDA1/code/lifespan_regression.R).\\]\n\n## 2. Multipel regression f칬r reklamdata\n\nVi g친r nu vidare med en multipel regressionsmodell med alla tre f칬rklarande variabler: `tv`, `radio` och `newspaper`. F칬rst en titt p친 data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2,2))\nhist(reklam$sales, col = \"orange\", main = \"\")\nplot(sales ~ tv, data = reklam, pch = 19, cex = 0.7, col = \"steelblue\")\nplot(sales ~ radio, data = reklam, pch = 19, cex = 0.7, col = \"steelblue\")\nplot(sales ~ newspaper, data = reklam, pch = 19, cex = 0.7, col = \"steelblue\")\n```\n\n::: {.cell-output-display}\n![](DatorLab7_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n#### 游눩 Uppgift 2.1\n\nAnpassa f칬ljande multipla regressionsmodell:\n\n$$\n\\texttt{sales} = \\beta_0 \n+ \\beta_1 \\cdot \\texttt{tv} \n+ \\beta_2 \\cdot \\texttt{radio} \n+ \\beta_3 \\cdot \\texttt{newspaper} \n+ \\varepsilon, \\hspace{1cm} \\varepsilon\\overset{iid}{\\sim}N(0,\\sigma_{\\varepsilon})\n$$\n\noch tolka skattningen av regressionskoefficienten f칬r `tv`.\n\n#### 游눩 Uppgift 2.2\n\nTesta om variabeln `tv` 칛r en signifikant f칬rklarande variabel p친 5% signifikansniv친. St칛ll upp noll- och alternativhypotes, teststatistiska med f칬rdelning under nollhypotesen. Utf칬r testet och formulera din slutsats. Du f친r anv칛nda information fr친n R, men du ska st칛lla upp formeln f칬r teststatistikan och ber칛kna den.\n\nKommentera kortfattat utifr친n utskriften om `radio` och `newspaper` 칛r signifikanta p친 5% signifikansniv친.\n\n#### 游눩 Uppgift 2.3\n\nVilken modell, den enkla regressionen eller den multipla, f칬redrar du? Motivera med relevant R v칛rde och genom att g칬ra 5-fold korsvalidering med funktionen `reg_crossval` i `sda123`-paketet.\n\n## 3. Residualanalys p친 simulerade data\n\nJag har simulerat fem olika datamaterial `simdata1-5` fr친n en linj칛r regressionsmodell:\n\n$$\n\\texttt{y} = \\beta_0 \n+ \\beta_1 \\cdot \\texttt{X1} \n+ \\beta_2 \\cdot \\texttt{X2} \n+ \\varepsilon\n$$\n\nd칛r i vissa datamaterial har feltermer $\\varepsilon$ som inte uppfyller alla av de fyra antagandena, och eventuellt kan det ocks친 finnas ett icke-linj칛rt samband mellan n친gon f칬rklarande variabel och y. Er uppgift 칛r att utf칬ra residualanalys med funktionen `reg_residuals` i `sda123`-paketet f칬r att f칬rs칬ka uppt칛cka vilka antaganden som inte 칛r uppfyllda i respektive datamaterial (Uppgift 3.1-3.5 nedan). Ni b칬r ocks친 titta p친 `plot(simdata1)` f칬r varje datamaterial f칬r att uppt칛cka icke-linj칛ra samband.\n\nH칛r 칛r de fem datamaterialen:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsimdata1 = read.csv(file = 'https://github.com/StatisticsSU/SDA1/raw/main/datorlab/lab7/simdata1.csv')\nsimdata2 = read.csv(file = 'https://github.com/StatisticsSU/SDA1/raw/main/datorlab/lab7/simdata2.csv')\nsimdata3 = read.csv(file = 'https://github.com/StatisticsSU/SDA1/raw/main/datorlab/lab7/simdata3.csv')\nsimdata4 = read.csv(file = 'https://github.com/StatisticsSU/SDA1/raw/main/datorlab/lab7/simdata4.csv')\nsimdata5 = read.csv(file = 'https://github.com/StatisticsSU/SDA1/raw/main/datorlab/lab7/simdata5.csv')\n```\n:::\n\n\n#### 游눩 Uppgift 3.1 - simdata1\n\n#### 游눩 Uppgift 3.2 - simdata2\n\n#### 游눩 Uppgift 3.3 - simdata3\n\n#### 游눩 Uppgift 3.4 - simdata4\n\n#### 游눩 Uppgift 3.5 - simdata5\n",
    "supporting": [
      "DatorLab7_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}