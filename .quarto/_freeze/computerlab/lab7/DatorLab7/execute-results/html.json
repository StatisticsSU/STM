{
  "hash": "331e69ef27b5865343d582075d5bef71",
  "result": {
    "markdown": "---\ntitle: \"Statistik och dataanalys I, 15 hp \"\nsubtitle: \"Datorlaboration 7 - Inferens för regression\"\nauthor: \n  - Mattias Villani\ndate: last-modified\nformat: \n  html:\n    self-contained: true\ntoc: true\nexecute:\n  error: false\nlanguage: \n  title-block-author-single: \" \"\ntoc-title-document: \"Innehåll\"\ncrossref-fig-title: \"Figur\"\ntheme: Superhero\ntitle-block-banner-color: Primary\ntitle-block-published: \"Publicerad\"\ncallout-warning-caption: \"Varning\"\ncallout-note-caption: \"Observera\"\ncallout-tip-caption: \"Tips\"\neditor: visual\n---\n\n\n::: callout-warning\n## Installera paket\n\nDen här labben förutsätter att följande paket finns installerade:\n\n-   `mosaic`\n-   `sda123`\n\nsda123 är kursens egna R-paket och måste installeras från GitHub. Det görs genom att först installera paketet remotes och därefter installera kurspaketet:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mosaic)\n# install.packages(\"remotes\") # avkommentera första gången\nlibrary(remotes)\n#install_github(\"StatisticsSU/sda1paket\")  # avkommentera första gången\nlibrary(sda123)\n```\n:::\n\n:::\n\n## Introduktion\n\n> I den här datorlabben kommer ni analysera olika datamaterial med regression. Det första datamaterialet om reklam är verkligt. I Uppgift 3 ska ni analysera datamaterial som är simulerade av mig, från olika populationsmodeller som jag har valt. Det blir ett intressant laboratorium, där ni kan utforska olika aspekter av regression i en kontrollerad miljö. Och även få veta den underliggande populationsmodellen efter att ni gjort labben!\n\n::: callout-important\n## Skapa mapp för labben\n\nSkapa en mapp `Lab7` i din kursmapp SDA1. Ladda ner Quarto-filen för denna lab genom att högerklicka [här](https://github.com/StatisticsSU/SDA1/raw/main/datorlab/lab7/DatorLab7.qmd) och välj 'Spara länk' eller något likande från menyn som dyker upp. Spara filen i din `Lab7` mapp. Öppna Quarto-filen i RStudio och fortsätt med denna laboration direkt i Quarto-dokumentet, där du också fyller i svaren på dina laborationsövningar.\n:::\n\n## 1. Enkel regression för reklamdata\n\nDatamaterialet `reklam.csv` innehåller data på *n=200* produkters försäljning (`sales`) i tusentals US dollar och hur mycket (i s k reklamenheter) produkten har marknadsförts i olika reklamkanaler: `tv`, `radio` och `newspaper`. Vi läser in data med kommandot:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreklam = read.csv(file = 'https://github.com/StatisticsSU/SDA1/raw/main/datorlab/lab7/reklam.csv')\nhead(reklam)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     tv radio newspaper sales\n1 230.1  37.8      69.2  22.1\n2  44.5  39.3      45.1  10.4\n3  17.2  45.9      69.3  12.0\n4 151.5  41.3      58.5  16.5\n5 180.8  10.8      58.4  17.9\n6   8.7  48.9      75.0   7.2\n```\n:::\n:::\n\n\nVi börjar med en enkel regressionsmodell med enbart `tv` som förklarande variabel. Vi utforskar data genom histogram för responsvariabeln `sales` och scatterplot mot `tv`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1,2))\nhist(reklam$sales, col = \"orange\", main = \"\")\nplot(sales ~ tv, data = reklam, pch = 19, cex = 0.7, col = \"steelblue\")\n```\n\n::: {.cell-output-display}\n![](DatorLab7_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n#### 💪 Uppgift 1.1\n\nSkatta den enkla linjära regressionsmodellen i R:\n\n$$\n\\texttt{sales} = \\beta_0 + \\beta_1 \\cdot \\texttt{tv} + \\varepsilon, \\hspace{1cm} \\varepsilon\\overset{iid}{\\sim}N(0,\\sigma_{\\varepsilon})\n$$\n\noch tolka skattningen av intercept och lutningskoefficient. Vilken skattning av $\\sigma_{\\varepsilon}$ ger R, och hur tolkar du denna?\n\n#### 💪 Uppgift 1.2\n\nTesta om variabeln tv är en signifikant förklarande variabel på 5% signifikansnivå. Ställ upp noll- och alternativhypotes, teststatistiska med fördelning under nollhypotesen. Utför testet med hjälp av formelsamlingen och formulera din slutsats. Du får använda information från R, men du ska ställa upp formeln för teststatistikan och beräkna med den formeln.\n\n#### 💪 Uppgift 1.3\n\nVisa hur R har beräknat p-värdet i regression-utskriften (från `summary`) genom att göra beräkningen själv med relevant s k `p`,`d`,`q`, eller `r`-funktion.\n\n#### 💪 Uppgift 1.4\n\nGör en residualanalys med funktionen `reg_residuals` i `sda123`-paketet, och kommentera om var och ett av de fyra grundläggande antaganden för populationsmodellen verkar uppfyllda.\n\n#### 💪 Uppgift 1.5\n\nGör en prediktion med 95%-igt prediktionsintervall för `sales` vid `tv=100`. \\[tips: argumentet `newdata` i `predict`-funktionen måste vara en dataframe, inte en vektor. Se min [kod för lifespan data](https://statisticssu.github.io/SDA1/code/lifespan_regression.R).\\]\n\n## 2. Multipel regression för reklamdata\n\nVi går nu vidare med en multipel regressionsmodell med alla tre förklarande variabler: `tv`, `radio` och `newspaper`. Först en titt på data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2,2))\nhist(reklam$sales, col = \"orange\", main = \"\")\nplot(sales ~ tv, data = reklam, pch = 19, cex = 0.7, col = \"steelblue\")\nplot(sales ~ radio, data = reklam, pch = 19, cex = 0.7, col = \"steelblue\")\nplot(sales ~ newspaper, data = reklam, pch = 19, cex = 0.7, col = \"steelblue\")\n```\n\n::: {.cell-output-display}\n![](DatorLab7_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n#### 💪 Uppgift 2.1\n\nAnpassa följande multipla regressionsmodell:\n\n$$\n\\texttt{sales} = \\beta_0 \n+ \\beta_1 \\cdot \\texttt{tv} \n+ \\beta_2 \\cdot \\texttt{radio} \n+ \\beta_3 \\cdot \\texttt{newspaper} \n+ \\varepsilon, \\hspace{1cm} \\varepsilon\\overset{iid}{\\sim}N(0,\\sigma_{\\varepsilon})\n$$\n\noch tolka skattningen av regressionskoefficienten för `tv`.\n\n#### 💪 Uppgift 2.2\n\nTesta om variabeln `tv` är en signifikant förklarande variabel på 5% signifikansnivå. Ställ upp noll- och alternativhypotes, teststatistiska med fördelning under nollhypotesen. Utför testet och formulera din slutsats. Du får använda information från R, men du ska ställa upp formeln för teststatistikan och beräkna den.\n\nKommentera kortfattat utifrån utskriften om `radio` och `newspaper` är signifikanta på 5% signifikansnivå.\n\n#### 💪 Uppgift 2.3\n\nVilken modell, den enkla regressionen eller den multipla, föredrar du? Motivera med relevant R² värde och genom att göra 5-fold korsvalidering med funktionen `reg_crossval` i `sda123`-paketet.\n\n## 3. Residualanalys på simulerade data\n\nJag har simulerat fem olika datamaterial `simdata1-5` från en linjär regressionsmodell:\n\n$$\n\\texttt{y} = \\beta_0 \n+ \\beta_1 \\cdot \\texttt{X1} \n+ \\beta_2 \\cdot \\texttt{X2} \n+ \\varepsilon\n$$\n\ndär i vissa datamaterial har feltermer $\\varepsilon$ som inte uppfyller alla av de fyra antagandena, och eventuellt kan det också finnas ett icke-linjärt samband mellan någon förklarande variabel och y. Er uppgift är att utföra residualanalys med funktionen `reg_residuals` i `sda123`-paketet för att försöka upptäcka vilka antaganden som inte är uppfyllda i respektive datamaterial (Uppgift 3.1-3.5 nedan). Ni bör också titta på `plot(simdata1)` för varje datamaterial för att upptäcka icke-linjära samband.\n\nHär är de fem datamaterialen:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsimdata1 = read.csv(file = 'https://github.com/StatisticsSU/SDA1/raw/main/datorlab/lab7/simdata1.csv')\nsimdata2 = read.csv(file = 'https://github.com/StatisticsSU/SDA1/raw/main/datorlab/lab7/simdata2.csv')\nsimdata3 = read.csv(file = 'https://github.com/StatisticsSU/SDA1/raw/main/datorlab/lab7/simdata3.csv')\nsimdata4 = read.csv(file = 'https://github.com/StatisticsSU/SDA1/raw/main/datorlab/lab7/simdata4.csv')\nsimdata5 = read.csv(file = 'https://github.com/StatisticsSU/SDA1/raw/main/datorlab/lab7/simdata5.csv')\n```\n:::\n\n\n#### 💪 Uppgift 3.1 - simdata1\n\n#### 💪 Uppgift 3.2 - simdata2\n\n#### 💪 Uppgift 3.3 - simdata3\n\n#### 💪 Uppgift 3.4 - simdata4\n\n#### 💪 Uppgift 3.5 - simdata5\n",
    "supporting": [
      "DatorLab7_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}